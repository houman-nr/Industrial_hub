<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/bootstrap-icons.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    {% comment %} <link rel="stylesheet" href="../../statics/css/styles.css"> {% endcomment %}
    
    <title>ویرایش تور</title>
</head>
<body>
    <ul class="formCircles">
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
    </ul>
    <div class="profilePopUpMenu">
        <header>
            <span class="profilePicture">
                <i class="bi bi-person-circle"></i>
                <span class="profileName">نام شرکت</span>
            </span>
            <button class="profilePopUpMenuCloseButton">
                <i class="bi bi-x-lg"></i>
            </button>
        </header>
        <div class="profileOptions">
            <ul>
                <li><a href="tourCreating.html">ساخت تور</a></li>
                <li><a href="tourEditing.html">ویرایش تور</a></li>
                <li><a href="">نظرات</a></li>
            </ul>
            <ul>
                <li><a href="">پروفایل</a></li>
                <li><a href="">پروفایل</a></li>
                <li><a href="">پروفایل</a></li>
            </ul>
        </div>
    </div>
    <div class="navBarSideBar">
        <div class="profileOptions">
            <ul>
                <li><a href="">تماس با ما</a></li>
                <li><a href="">پنل فروشندگان و خریداران</a></li>
                <li><a href="">لیست شرکت ها</a></li>
            </ul>
        </div>
    </div>
    <label for="navBarSidBarCheckBox" id="navbarCollapse">
        <input type="checkbox" id="navBarSidBarCheckBox">
        <button class="navbarCollapseButton">
            <i class="bi bi-list"></i>
        </button>
    </label>
    <div class='Header'>
        <div class='top'>
            <img class="headerLogoImage" src="{% static 'images/Logo.png' %}" alt="لوگو" />
            <input type="checkbox" id="openForm">
            <button class="profileButton">
                <i class="bi bi-person-circle"></i>
            </button>
        </div>
        
        <ul class='HeaderNavBarContainer'>
            <li><a href="">تماس با ما</a></li>
            <li><a href="">پنل فروشندگان و خریداران</a></li>
            <li><a href="">لیست شرکت ها</a></li>
        </ul>
        <div class='searchBarContainer'>
            <a href="" class='searchBarIcon'>
                <i class="bi bi-search"></i>
            </a>
            <input type="text"  placeholder='جست و جو......' class='searchBarInput'/>
        </div>
    </div>
    <div class="homePageBody">
        <div class="tourCreateContainer">
            <style>
                .file-list {
                    list-style-type: none;
                    padding: 0;
                }
                .file-item {
                    margin: 5px 0;
                    display: flex;
                    align-items: center;
                }
                .file-item img, .file-item video {
                    max-width: 50px;
                    max-height: 50px;
                    margin-right: 10px;
                }
                .file-item button {
                    margin-left: 10px;
                }
            </style>

            <header>
                <h2>ویرایش تور</h2>
            </header>

            
            <form id="uploadForm" action="upload.php" method="post" enctype="multipart/form-data">
                <div class="imageSection">
                    <div class="imageUploadSection">
                        <label for="profileImageUpload">تصویر پروفایل خود را آپلود کنید:</label>
                        <input type="file" id="profileImageUpload" accept="image/*">
                    </div>
            
                    <div class="uploadedImagesSection">
                        <h4>تصویر پروفایل آپلود شده</h4>
                        <ul class="file-list" id="profileImageList">
                            <li>-----</li>
                        </ul>
                    </div>
                </div>

                <div class="imageSection">
                    <div class="imageUploadSection">
                        <label for="imageUpload">تصاویر خود را آپلود کنید:</label>
                        <input type="file"  id="imageUpload" accept="image/*" multiple>
                    </div>

                    <div class="uploadedImagesSection">
                        <h4>تصاویر آپلود شده</h4>
                        <ul class="file-list" id="imageList">
                            <li>-----</li>
                        </ul>
                    </div>
                </div>

                <div class="videoSection">
                    <div class="videoUploadSection">
                        <label for="videoUpload">ویدئوهای خود را آپلود کنید:</label>
                        <input type="file" id="videoUpload" accept="video/*" multiple>
                    </div>

                    <div class="uploadedVideosSection">
                        <h4>ویدئو های آپلود شده</h4>
                        <ul class="file-list" id="videoList"></ul>
                    </div>
                </div>

                <div class="descriptionSection">
                    <label for="description"><h5>توضیحات:</h5></label>
                    <textarea id="description" name="description" rows="4" cols="50" placeholder="توضیحاتی در مورد شرکت....." required></textarea><br><br>
                </div>


                <input type="submit" value="اعمال تغییرات">
            </form>

            <script>
                const profileImageInput = document.getElementById('profileImageUpload');
                const imageInput = document.getElementById('imageUpload');
                const videoInput = document.getElementById('videoUpload');
                const profileImageList = document.getElementById('profileImageList');
                const imageList = document.getElementById('imageList');
                const videoList = document.getElementById('videoList');
                const uploadForm = document.getElementById('uploadForm');
            
                let profileImage = null;
                let imageArray = [];
                let videoArray = [];
            
                profileImageInput.addEventListener('change', handleProfileImageSelect);
                imageInput.addEventListener('change', handleImageSelect);
                videoInput.addEventListener('change', handleVideoSelect);
                profileImageList.addEventListener('click', handleProfileImageRemove);
                imageList.addEventListener('click', handleFileRemove);
                videoList.addEventListener('click', handleFileRemove);
            
                function handleProfileImageSelect(event) {
                    const file = event.target.files[0];
                    profileImage = file;
                    renderProfileImage(profileImage, profileImageList);
                }
            
                function handleImageSelect(event) {
                    const files = Array.from(event.target.files);
                    imageArray = imageArray.concat(files);
                    renderFileList(imageArray, imageList, 'image');
                }
            
                function handleVideoSelect(event) {
                    const files = Array.from(event.target.files);
                    videoArray = videoArray.concat(files);
                    renderFileList(videoArray, videoList, 'video');
                }
            
                function handleProfileImageRemove(event) {
                    if (event.target.tagName === 'BUTTON') {
                        profileImage = null;
                        renderProfileImage(null, profileImageList);
                    }
                }
            
                function handleFileRemove(event) {
                    if (event.target.tagName === 'BUTTON') {
                        const index = event.target.getAttribute('data-index');
                        const type = event.target.getAttribute('data-type');
                        if (type === 'image') {
                            imageArray.splice(index, 1);
                            renderFileList(imageArray, imageList, 'image');
                        } else if (type === 'video') {
                            videoArray.splice(index, 1);
                            renderFileList(videoArray, videoList, 'video');
                        }
                    }
                }
            
                function renderProfileImage(file, fileList) {
                    fileList.innerHTML = '';
                    if (file) {
                        const listItem = document.createElement('li');
                        listItem.classList.add('file-item');
            
                        const filePreview = document.createElement('img');
                        filePreview.src = URL.createObjectURL(file);
                        filePreview.alt = 'Profile Image';
            
                        listItem.innerHTML = `
                            <span>${file.name}</span>
                            <button type="button" data-type="profile"><i class="bi bi-x-lg"></i></button>
                        `;
                        listItem.insertBefore(filePreview, listItem.firstChild);
                        fileList.appendChild(listItem);
                    } else {
                        const listItem = document.createElement('li');
                        listItem.textContent = '-----';
                        fileList.appendChild(listItem);
                    }
                }
            
                function renderFileList(fileArray, fileList, type) {
                    fileList.innerHTML = '';
                    fileArray.forEach((file, index) => {
                        const listItem = document.createElement('li');
                        listItem.classList.add('file-item');
            
                        const filePreview = document.createElement('img');
                        if (type === 'image') {
                            filePreview.src = URL.createObjectURL(file);
                        } else if (type === 'video') {
                            filePreview.src = 'path_to_static_video_thumbnail_image'; // Replace with the path to your static image
                        }
            
                        listItem.innerHTML = `
                            <span>${file.name}</span>
                            <button type="button" data-index="${index}" data-type="${type}"><i class="bi bi-x-lg"></i></button>
                        `;
                        listItem.insertBefore(filePreview, listItem.firstChild);
                        fileList.appendChild(listItem);
                    });
                }
            
                uploadForm.addEventListener('submit', (event) => {
                    event.preventDefault();
            
                    const formData = new FormData(uploadForm);
                    if (profileImage) {
                        formData.append('profileImage', profileImage);
                    }
                    imageArray.forEach(file => {
                        formData.append('images[]', file);
                    });
                    videoArray.forEach(file => {
                        formData.append('videos[]', file);
                    });
            
                    fetch('upload.php', {
                        method: 'POST',
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        alert('Files uploaded successfully!');
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    });
                });
            </script>

        </div>
    </div>
</body>
<script src="script.js"></script>
</html>
